<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>デリバリー九州様 採用広告予算5000万円回復 戦略提案ダッシュボード</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices:
        - Effective Job Openings Ratio: Line chart (Chart.js) to show trends. Goal: Inform. Interaction: Hover for details. Justification: Clearly visualizes market tightness.
        - Labor Shortage: Bar chart (Chart.js) for scale. Goal: Inform. Interaction: Click to see impact details. Justification: Highlights urgency.
        - Minimum Wage Trend: Line chart (Chart.js). Goal: Inform. Justification: Shows rising cost pressures.
        - Competitor Salary Comparison: Bar chart (Chart.js). Goal: Compare. Interaction: Filter by job type. Justification: Benchmarks DelivKyusyu's position.
        - Budget Impact: Key metric callouts (HTML/CSS) and simple cost-benefit text. Goal: Persuade. Justification: Directly addresses the core proposal.
        - Media Mix: Donut chart (Chart.js) for budget allocation, cards (HTML/CSS) for media details. Goal: Organize/Inform. Justification: Clarifies strategic spending.
        - Targeted Ad Content: Tabbed interface (HTML/JS). Goal: Organize. Justification: Shows tailored approaches.
        - CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: "Inter", "Hiragino Kaku Gothic ProN", "メイリオ", Meiryo, sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 400px; }
        @media (min-width: 768px) { .chart-container { height: 350px; } }
        .nav-link { transition: all 0.3s ease; }
        .nav-link.active { background-color: #0284c7; color: white; }
        .nav-link:not(.active):hover { background-color: #e0f2fe; }
        .tab-button.active { border-bottom-color: #0284c7; color: #0284c7; }
        .tooltip {
            position: absolute;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.875rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div class="container mx-auto p-4 md:p-8">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-sky-700">デリバリー九州様 採用広告予算5000万円回復</h1>
            <p class="text-xl text-slate-600 mt-2">戦略提案ダッシュボード</p>
        </header>

        <nav class="mb-8 bg-white shadow-md rounded-lg p-2">
            <ul class="flex flex-wrap justify-center gap-2">
                <li><a href="#introduction" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700 active">はじめに</a></li>
                <li><a href="#current-challenges" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">現状の課題</a></li>
                <li><a href="#market-reality" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">市場の叫び</a></li>
                <li><a href="#competitive-landscape" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">ライバル動向</a></li>
                <li><a href="#budget-impact" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">予算回復のインパクト</a></li>
                <li><a href="#strategic-actions" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">勝利への戦略</a></li>
                <li><a href="#conclusion" class="nav-link block py-2 px-4 rounded-md font-medium text-slate-700">まとめ</a></li>
            </ul>
        </nav>

        <main>
            <section id="introduction" class="content-section p-6 bg-white rounded-lg shadow mb-8">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">はじめに</h2>
                <p class="text-slate-700 leading-relaxed">本ダッシュボードへようこそ。ここでは、デリバリー九州様の採用広告予算を5000万円に回復させることの戦略的重要性と、それによって期待される効果をインタラクティブにご覧いただけます。まずは、なぜ今、採用への投資が不可欠なのか、その背景からご説明します。</p>
                <p class="mt-3 text-slate-700 leading-relaxed">熊本県の飲食業界は深刻な人手不足に直面しており、安定的な人材確保は事業成長の鍵です。本提案は、採用広告予算の回復が、コスト増ではなく競争力強化と成長機会確保のための戦略的投資であることを示します。</p>
            </section>

            <section id="current-challenges" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">現状の課題：デリバリー九州が直面する採用の壁</h2>
                <p class="text-slate-700 leading-relaxed mb-6">デリバリー九州様が現在直面されている採用に関する課題と、予算削減がもたらす潜在的なリスクについて掘り下げます。具体的なデータと共に、現状認識を深めていきましょう。</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">従業員構成と依存度</h3>
                        <p class="text-sm text-slate-600">正社員50名、パート・アルバイト450名（約90%がパート・アルバイト）。この構成は労働市場の変動リスクを内包します。</p>
                    </div>
                    <div class="bg-red-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-red-700 mb-2">採用予算削減の影響</h3>
                        <ul class="list-disc list-inside text-sm text-red-600 space-y-1">
                            <li>サービスの質と顧客満足度の低下</li>
                            <li>営業時間短縮・休業日増加による売上機会損失</li>
                            <li>業務効率低下、食材ロス増加、利益率低下</li>
                            <li>長期的な顧客基盤の毀損とブランドイメージ悪化</li>
                        </ul>
                        <p class="mt-2 text-sm text-red-700 font-semibold">予算削減は、目先のコスト減以上に長期的な経営リスクを増大させます。</p>
                    </div>
                </div>
                 <div class="mt-6 bg-amber-50 p-4 rounded-lg border border-amber-300">
                    <h3 class="text-lg font-semibold text-amber-700 mb-2">機会損失の大きさ</h3>
                    <p class="text-sm text-amber-600">採用が滞ることで、既存店舗が本来生み出せるはずの収益を失い、ブランドイメージも損なう「機会損失」は非常に大きいです。採用予算は、この機会損失を防ぐ「保険」であり「成長投資」です。</p>
                </div>
            </section>

            <section id="market-reality" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">市場の叫び：熊本の労働市場は今</h2>
                <p class="text-slate-700 leading-relaxed mb-6">熊本県の飲食業界を取り巻く労働市場の現状を客観的なデータで示します。有効求人倍率、深刻な人手不足、そして上昇する賃金トレンドが、採用戦略にどのような影響を与えるかをご確認ください。</p>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">有効求人倍率</h3>
                        <p class="text-3xl font-bold text-sky-600">1.21<span class="text-sm">倍</span></p>
                        <p class="text-xs text-slate-500">(熊本県全体、2025年3月)</p>
                        <p class="text-sm text-slate-600 mt-1">求職者優位の「売り手市場」が継続。飲食サービス業の新規求人数は<strong class="text-red-600">2.9%増</strong> (前年同月比)。</p>
                        <div class="chart-container mt-4 mx-auto h-48 md:h-56">
                            <canvas id="jobOpeningsRatioChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">人手不足の深刻度</h3>
                        <p class="text-3xl font-bold text-red-600">月7,000～8,000<span class="text-sm">人</span></p>
                        <p class="text-xs text-slate-500">(熊本県全体、R5-R6推計)</p>
                        <p class="text-sm text-slate-600 mt-1">飲食店の閉店理由上位に「人手不足」。事業継続を脅かす構造的問題。</p>
                        <div class="chart-container mt-4 mx-auto h-48 md:h-56">
                            <canvas id="laborShortageChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">最低賃金の上昇</h3>
                        <p class="text-3xl font-bold text-amber-600">952<span class="text-sm">円</span></p>
                        <p class="text-xs text-slate-500">(熊本県、2024年)</p>
                        <p class="text-sm text-slate-600 mt-1">2025年は<strong class="text-amber-700">1,000円超</strong>確実。人件費の構造的増加は不可避。</p>
                         <div class="chart-container mt-4 mx-auto h-48 md:h-56">
                            <canvas id="minimumWageChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="competitive-landscape" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">ライバル動向：競合他社はどう動いている？</h2>
                <p class="text-slate-700 leading-relaxed mb-6">競争が激化する採用市場において、競合他社はどのような採用戦略を展開しているのでしょうか。給与水準や求人媒体の活用状況を分析し、デリバリー九州様が取るべき差別化戦略のヒントを探ります。</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">競合の給与水準 (熊本市内居酒屋)</h3>
                        <div class="chart-container mt-4 mx-auto">
                            <canvas id="competitorSalaryChart"></canvas>
                        </div>
                        <div class="text-xs text-slate-500 mt-2 text-center">
                            <p>正社員月給: 23.5万～30.3万円 (平均25.9万円)</p>
                            <p>アルバイト時給: 960円～1,260円 (平均1,193円)</p>
                            <p class="mt-1">デリバリー九州様運営店舗例: 焼肉ライク時給1000～1100円、福よしOP時給1200円</p>
                        </div>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">主要求人媒体と差別化</h3>
                        <p class="text-sm text-slate-600 mb-2">競合もタウンワーク、求人ボックス等で積極的に採用活動中。デリバリー九州様も同媒体でFC店舗を掲載。</p>
                        <div class="bg-sky-100 border-l-4 border-sky-500 text-sky-700 p-3 rounded-md">
                            <p class="font-semibold">差別化のポイント:</p>
                            <ul class="list-disc list-inside text-sm mt-1">
                                <li>多様なブランド経験 (FC + 自社ブランド)</li>
                                <li>手厚い教育制度、経営ノウハウ習得</li>
                                <li>明確なキャリアパス</li>
                                <li>安定した企業基盤</li>
                            </ul>
                        </div>
                        <p class="text-sm text-slate-600 mt-3">予算回復は、単なる露出増だけでなく、これらの強みを際立たせる広告内容の質向上に繋げることが重要です。</p>
                    </div>
                </div>
            </section>

            <section id="budget-impact" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">予算回復のインパクト：5000万円で何が変わる？</h2>
                <p class="text-slate-700 leading-relaxed mb-6">採用広告予算を5000万円に回復させることで、具体的にどのような効果が期待できるのでしょうか。人手不足による機会損失の回避から、採用効率の改善まで、投資の費用対効果を明らかにします。</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-green-50 p-4 rounded-lg border border-green-300">
                        <h3 class="text-xl font-semibold text-green-700 mb-2">予算回復の戦略的意義</h3>
                        <ul class="list-disc list-inside text-sm text-green-600 space-y-1">
                            <li>深刻な人手不足による経営リスク回避</li>
                            <li>採用市場での存在感維持・強化</li>
                            <li>優秀な人材の安定的確保</li>
                            <li>「攻めの投資」による将来成長の確保</li>
                        </ul>
                        <p class="mt-2 text-sm text-green-700">物価や最低賃金上昇を考慮すると、5000万円は現状維持のための最低限の投資であり、さらなる成長には増額も視野に。</p>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg">
                        <h3 class="text-xl font-semibold text-sky-700 mb-2">費用対効果の視点</h3>
                        <p class="text-sm text-slate-600 mb-2">飲食業界の広告宣伝費目安は売上の3～5%。5000万円が売上に対し妥当か検証が必要です。</p>
                        <p class="text-sm text-slate-600 mb-1"><strong class="font-semibold">採用単価目安:</strong></p>
                        <ul class="list-disc list-inside text-sm text-slate-600 ml-4">
                            <li>アルバイト: 2万～40万円/月</li>
                            <li>中途採用: 20万～100万円/月</li>
                        </ul>
                        <p class="text-sm text-slate-600 mt-2">5000万円で何名採用可能か、目標採用単価を設定し、戦略的な媒体選定と迅速な応募者対応でROIを最大化します。</p>
                    </div>
                </div>
                <div class="mt-6 bg-red-50 p-4 rounded-lg border border-red-300">
                    <h3 class="lg:text-lg font-semibold text-red-700 mb-2">予算削減の負のサイクル</h3>
                    <p class="text-sm text-red-600">求人広告費用削減 → 応募数減少 → <strong class="font-semibold">採用単価上昇</strong> → 応募者質低下・早期離職リスク増</p>
                    <p class="text-sm text-red-600 mt-1">5000万円への回帰は、この負のサイクルを断ち切り、採用活動の健全性と効率性を回復させる不可欠な投資です。</p>
                </div>
            </section>

            <section id="strategic-actions" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">勝利への戦略：具体的なアクションプラン</h2>
                <p class="text-slate-700 leading-relaxed mb-6">5000万円の予算を最大限に活かすための具体的な戦略をご提案します。効果的な求人媒体の選定、ターゲット層に響く広告内容の最適化など、採用成功に向けたアクションプランです。</p>
                
                <div class="mb-6">
                    <h3 class="text-xl font-semibold text-sky-700 mb-3">1. 効果的な求人媒体の選定と活用（メディアミックス）</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="bg-slate-100 p-3 rounded-lg">
                            <h4 class="font-semibold text-md text-sky-800">Indeed</h4>
                            <p class="text-xs text-slate-600">正社員向け。キャリアパスの魅力（教育制度、経営ノウハウ）を訴求。クリック課金型で費用対効果を追求。</p>
                        </div>
                        <div class="bg-slate-100 p-3 rounded-lg">
                            <h4 class="font-semibold text-md text-sky-800">Baitoru/Townwork 等</h4>
                            <p class="text-xs text-slate-600">アルバイト・パート向け。学生・主婦層にリーチ。柔軟なシフト、待遇（Wワーク、髪型自由等）を強調。</p>
                        </div>
                        <div class="bg-slate-100 p-3 rounded-lg">
                            <h4 class="font-semibold text-md text-sky-800">自社採用サイト/SNS</h4>
                            <p class="text-xs text-slate-600">ブランドイメージ構築。理念、多様なブランド、社員の声を発信。採用単価低減に貢献。</p>
                        </div>
                    </div>
                    <div class="chart-container mt-4 mx-auto h-64 md:h-72">
                         <canvas id="mediaMixChart"></canvas>
                    </div>
                    <p class="text-xs text-slate-500 text-center mt-1">メディアミックスによる予算配分イメージ（戦略に応じて調整）</p>
                </div>

                <div>
                    <h3 class="text-xl font-semibold text-sky-700 mb-3">2. 採用ターゲット層に合わせた広告内容の最適化</h3>
                    <div class="border-b border-slate-200 mb-2">
                        <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                            <button class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm text-slate-500 hover:text-sky-600 hover:border-sky-300 active" data-target="tab-unexperienced">未経験者・若年層</button>
                            <button class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm text-slate-500 hover:text-sky-600 hover:border-sky-300" data-target="tab-career">長期キャリア志向者</button>
                            <button class="tab-button whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm text-slate-500 hover:text-sky-600 hover:border-sky-300" data-target="tab-parttime">アルバイト・パート</button>
                        </nav>
                    </div>
                    <div id="tab-content" class="mt-4">
                        <div id="tab-unexperienced" class="tab-pane active">
                            <h4 class="font-semibold text-md text-sky-800 mb-1">未経験者・若年層向け訴求ポイント</h4>
                            <ul class="list-disc list-inside text-sm text-slate-600 space-y-1">
                                <li>「未経験歓迎」「学歴不問」を明確に</li>
                                <li>手厚い教育制度、マニュアルの存在を具体的に説明</li>
                                <li>安心して応募できる環境をアピール</li>
                                <li>多様なブランドでの経験機会</li>
                            </ul>
                        </div>
                        <div id="tab-career" class="tab-pane hidden">
                            <h4 class="font-semibold text-md text-sky-800 mb-1">長期キャリア志向者向け訴求ポイント</h4>
                            <ul class="list-disc list-inside text-sm text-slate-600 space-y-1">
                                <li>「経営者のノウハウも学べる」</li>
                                <li>「幅広い飲食店のノウハウを一つの会社で経験できる」</li>
                                <li>店長、エリアマネージャーなど具体的なキャリアパス提示</li>
                                <li>独立支援制度など将来の展望</li>
                            </ul>
                        </div>
                        <div id="tab-parttime" class="tab-pane hidden">
                            <h4 class="font-semibold text-md text-sky-800 mb-1">アルバイト・パート向け訴求ポイント</h4>
                            <ul class="list-disc list-inside text-sm text-slate-600 space-y-1">
                                <li>柔軟なシフト（週1日、1日4h～OKなど具体的に）</li>
                                <li>WワークOK、扶養内勤務OK</li>
                                <li>髪色・髪型自由、ネイルOKなど身だしなみ規定</li>
                                <li>まかない無料/補助、従業員割引（優待券）</li>
                                <li>オープニング店舗の高時給アピール</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="conclusion" class="content-section p-6 bg-white rounded-lg shadow mb-8 hidden">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4">まとめ：未来への投資</h2>
                <p class="text-slate-700 leading-relaxed mb-4">本提案の要点を改めて確認し、採用広告予算の回復がデリバリー九州様の持続的な成長にとって不可欠な戦略的投資であることを結論付けます。未来への確かな一歩を、共に踏み出しましょう。</p>
                <div class="bg-sky-50 border-l-4 border-sky-500 text-sky-700 p-4 rounded-md">
                    <p class="font-semibold mb-2">結論として：</p>
                    <ul class="list-disc list-inside text-sm space-y-1">
                        <li>熊本県飲食業界の厳しい労働市場環境下では、積極的な採用投資が不可欠です。</li>
                        <li>5000万円への予算回復は、人手不足による機会損失回避、サービス品質向上、顧客満足度と利益率改善に繋がる戦略的投資です。</li>
                        <li>メディアミックス戦略、ターゲット別広告最適化、採用プロセス効率化により、投資対効果を最大化します。</li>
                        <li>この投資は、短期的な課題解決に留まらず、長期的な企業価値向上に貢献する重要な経営判断です。</li>
                    </ul>
                </div>
            </section>
        </main>

        <footer class="mt-12 text-center text-sm text-slate-500">
            <p>&copy; <span id="currentYear"></span> 株式会社リクルート デリバリー九州様向けご提案資料</p>
        </footer>
    </div>
    <div id="tooltip" class="tooltip"></div>

<script>
    document.getElementById('currentYear').textContent = new Date().getFullYear();

    const navLinks = document.querySelectorAll('.nav-link');
    const contentSections = document.querySelectorAll('.content-section');
    const tooltip = document.getElementById('tooltip');

    function updateActiveSection() {
        let currentSectionId = 'introduction';
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;

        contentSections.forEach(section => {
            if (section.offsetTop <= scrollPosition + window.innerHeight / 2 && !section.classList.contains('hidden')) {
                 currentSectionId = section.id;
            }
        });
        
        if (window.location.hash) {
            const hashId = window.location.hash.substring(1);
            if (document.getElementById(hashId)) {
                 currentSectionId = hashId;
            }
        }

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + currentSectionId) {
                link.classList.add('active');
            }
        });

        contentSections.forEach(section => {
            if (section.id === currentSectionId) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        });
    }
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            
            history.pushState(null, null, '#' + targetId); // Update URL hash
            updateActiveSection();

            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                 // Scroll smoothly to the section
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });
    });
    
    window.addEventListener('hashchange', updateActiveSection);
    window.addEventListener('load', updateActiveSection); // Ensure correct section is shown on load/refresh


    // Tab functionality
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabPanes = document.querySelectorAll('.tab-pane');

    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            tabButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            const targetPaneId = button.dataset.target;
            tabPanes.forEach(pane => {
                if (pane.id === targetPaneId) {
                    pane.classList.remove('hidden');
                    pane.classList.add('active');
                } else {
                    pane.classList.remove('active');
                    pane.classList.add('hidden');
                }
            });
        });
    });
    
    // Chart.js label wrapping function
    function wrapText(ctx, text, maxWidth) {
        const words = text.split('');
        let lines = [];
        let currentLine = '';
        for (let i = 0; i < words.length; i++) {
            let testLine = currentLine + words[i];
            let metrics = ctx.measureText(testLine);
            let testWidth = metrics.width;
            if (testWidth > maxWidth && i > 0) {
                lines.push(currentLine);
                currentLine = words[i];
            } else {
                currentLine = testLine;
            }
        }
        lines.push(currentLine);
        return lines;
    }

    // Tooltip configuration
    const tooltipPlugin = {
        id: 'customTooltip',
        afterDraw: chart => {
            // Check if the tooltip exists and has body content before proceeding
            if (chart.tooltip && chart.tooltip.body && chart.tooltip.body.length) {
                // Ensure there's an active element to get position from
                if (!chart.tooltip._active || chart.tooltip._active.length === 0) {
                    tooltip.style.opacity = 0;
                    return;
                }

                const activeElement = chart.tooltip._active[0];
                const ctx = chart.ctx;
                const tooltipEl = document.getElementById('tooltip');
                
                const position = activeElement.element.tooltipPosition();
                
                tooltipEl.innerHTML = ''; 
                
                const titleLines = chart.tooltip.title || [];
                titleLines.forEach(title => {
                    const titleEl = document.createElement('div');
                    titleEl.style.fontWeight = 'bold';
                    titleEl.style.marginBottom = '5px';
                    titleEl.innerText = title;
                    tooltipEl.appendChild(titleEl);
                });

                // Safely get body lines, handling cases where b.lines might be undefined
                const bodyLines = chart.tooltip.body.flatMap(b => b.lines || []);
                bodyLines.forEach((body, i) => {
                    const colors = chart.tooltip.labelColors[i];
                    const bodyEl = document.createElement('div');
                    bodyEl.style.display = 'flex';
                    bodyEl.style.alignItems = 'center';

                    const span = document.createElement('span');
                    span.style.background = colors ? colors.backgroundColor : 'transparent'; // Defensive check for colors
                    span.style.borderColor = colors ? colors.borderColor : 'transparent';
                    span.style.borderWidth = '2px';
                    span.style.marginRight = '10px';
                    span.style.height = '10px';
                    span.style.width = '10px';
                    span.style.display = 'inline-block';
                    bodyEl.appendChild(span);
                    
                    const textEl = document.createTextNode(body);
                    bodyEl.appendChild(textEl);
                    tooltipEl.appendChild(bodyEl);
                });

                tooltipEl.style.opacity = 1;
                tooltipEl.style.left = chart.canvas.offsetLeft + position.x + 'px';
                tooltipEl.style.top = chart.canvas.offsetTop + position.y + 'px';
                tooltipEl.style.font = chart.tooltip.options.bodyFont.string;
                tooltipEl.style.padding = chart.tooltip.options.padding + 'px ' + chart.tooltip.options.padding + 'px';
            } else {
                tooltip.style.opacity = 0;
            }
        }
    };
    
    Chart.defaults.font.family = '"Inter", "Hiragino Kaku Gothic ProN", "メイリオ", Meiryo, sans-serif';
    Chart.defaults.plugins.tooltip.enabled = false; // Disable default tooltip
    Chart.defaults.plugins.tooltip.mode = 'index';
    Chart.defaults.plugins.tooltip.intersect = false;
    Chart.defaults.plugins.tooltip.callbacks.label = function(context) {
        let label = context.dataset.label || '';
        if (label) {
            label += ': ';
        }
        if (context.parsed.y !== null) {
            label += new Intl.NumberFormat('ja-JP').format(context.parsed.y);
            if (context.dataset.unit) label += context.dataset.unit;
        }
        return label;
    };


    // Chart Data & Initialization
    const chartColors = {
        sky: 'rgb(2, 132, 199)',
        amber: 'rgb(217, 119, 6)',
        red: 'rgb(220, 38, 38)',
        green: 'rgb(22, 163, 74)',
        slate: 'rgb(71, 85, 105)',
        indigo: 'rgb(79, 70, 229)',
        teal: 'rgb(13, 148, 136)'
    };

    // 1. Effective Job Openings Ratio Chart
    const jobOpeningsCtx = document.getElementById('jobOpeningsRatioChart').getContext('2d');
    new Chart(jobOpeningsCtx, {
        type: 'line',
        data: {
            labels: ['2024年9月', '2024年12月', '2025年3月'],
            datasets: [{
                label: '熊本県 有効求人倍率',
                data: [1.18, 1.19, 1.21],
                borderColor: chartColors.sky,
                backgroundColor: chartColors.sky + '33', // transparent
                tension: 0.1,
                fill: true,
                unit: '倍'
            }, {
                label: '飲食サービス業 (イメージ)',
                data: [1.3, 1.35, 1.4], // Fictional data to show higher trend
                borderColor: chartColors.amber,
                backgroundColor: chartColors.amber + '33',
                tension: 0.1,
                fill: true,
                unit: '倍'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { y: { beginAtZero: true, suggestedMax: 1.5 } },
            plugins: { legend: { position: 'bottom' } }
        },
        plugins: [tooltipPlugin]
    });

    // 2. Labor Shortage Chart
    const laborShortageCtx = document.getElementById('laborShortageChart').getContext('2d');
    new Chart(laborShortageCtx, {
        type: 'bar',
        data: {
            labels: ['熊本県全体 推計不足人数'],
            datasets: [{
                label: '月平均不足人数',
                data: [7500], // Average of 7000-8000
                backgroundColor: chartColors.red,
                unit: '人'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { y: { beginAtZero: true, suggestedMax: 10000 } },
            plugins: { legend: { display: false } }
        },
        plugins: [tooltipPlugin]
    });
    
    // 3. Minimum Wage Chart
    const minimumWageCtx = document.getElementById('minimumWageChart').getContext('2d');
    new Chart(minimumWageCtx, {
        type: 'line',
        data: {
            labels: ['2022年', '2023年', '2024年', '2025年 (予測)'],
            datasets: [{
                label: '熊本県 最低賃金',
                data: [853, 898, 952, 1010], // 2023 = 952-54, 2022 = 898-45. Assuming 1010 for 2025
                borderColor: chartColors.amber,
                backgroundColor: chartColors.amber + '33',
                tension: 0.1,
                fill: true,
                unit: '円'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { y: { beginAtZero: false, suggestedMin: 800 } },
            plugins: { legend: { position: 'bottom' } }
        },
        plugins: [tooltipPlugin]
    });

    // 4. Competitor Salary Chart
    const competitorSalaryCtx = document.getElementById('competitorSalaryChart').getContext('2d');
    new Chart(competitorSalaryCtx, {
        type: 'bar',
        data: {
            labels: ['正社員 平均月給', 'アルバイト 平均時給'],
            datasets: [{
                label: '競合他社 (熊本市居酒屋)',
                data: [25.9, 1193], // 25.9万円, 1193円
                backgroundColor: [chartColors.sky, chartColors.teal],
                unit: ['', '円'] //万円はカスタムツールチップで対応
            }, {
                label: 'デリバリー九州 (例: 焼肉ライク)',
                data: [null, 1050], // 正社員データなし, 時給1000-1100の中間
                backgroundColor: [chartColors.amber, chartColors.amber],
                 unit: ['', '円']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { 
                y: { 
                    beginAtZero: true,
                    ticks: {
                        callback: function(value, index, values) {
                            if (this.getLabelForValue(value).includes('月給')) { // Check if it's the salary bar
                                return value + '万円';
                            }
                            return value + '円';
                        }
                    }
                } 
            },
            plugins: { 
                legend: { position: 'bottom' },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                if (context.label.includes('月給')) {
                                     label += context.parsed.y + '万円';
                                } else {
                                     label += new Intl.NumberFormat('ja-JP').format(context.parsed.y) + '円';
                                }
                            }
                            return label;
                        }
                    }
                }
            }
        },
        plugins: [tooltipPlugin]
    });

    // 5. Media Mix Chart
    const mediaMixCtx = document.getElementById('mediaMixChart').getContext('2d');
    new Chart(mediaMixCtx, {
        type: 'doughnut',
        data: {
            labels: ['Indeed (正社員)', 'Baitoru/Townwork等 (アルバイト)', '自社サイト/SNS', 'その他・予備費'],
            datasets: [{
                label: '予算配分イメージ',
                data: [35, 40, 15, 10], // Example distribution
                backgroundColor: [chartColors.sky, chartColors.teal, chartColors.amber, chartColors.slate],
                hoverOffset: 4,
                unit: '%'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
                legend: { 
                    position: 'bottom',
                    labels: {
                        generateLabels: function(chart) {
                            const data = chart.data;
                            if (data.labels.length && data.datasets.length) {
                                return data.labels.map((label, i) => {
                                    const meta = chart.getDatasetMeta(0);
                                    const style = meta.controller.getStyle(i);
                                    const value = data.datasets[0].data[i];
                                    const text = `${label}: ${value}%`; // Add percentage to label
                                    
                                    // Wrap text logic
                                    const canvas = chart.canvas;
                                    const ctx = canvas.getContext('2d');
                                    const maxWidth = 120; // Max width for legend item text
                                    const wrappedText = wrapText(ctx, text, maxWidth);


                                    return {
                                        text: wrappedText, // Use wrapped text
                                        fillStyle: style.backgroundColor,
                                        strokeStyle: style.borderColor,
                                        lineWidth: style.borderWidth,
                                        hidden: !chart.getDataVisibility(i),
                                        index: i
                                    };
                                });
                            }
                            return [];
                        }
                    }
                },
                tooltip: {
                     callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed !== null) {
                                label += context.parsed + '%';
                            }
                            return label;
                        }
                    }
                }
            }
        },
        plugins: [tooltipPlugin]
    });

</script>
</body>
</html>
